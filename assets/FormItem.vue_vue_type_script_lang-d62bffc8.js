var ne=Object.defineProperty,le=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var K=(e,f,u)=>f in e?ne(e,f,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[f]=u,d=(e,f)=>{for(var u in f||(f={}))re.call(f,u)&&K(e,u,f[u]);if($)for(var u of $(f))ce.call(f,u)&&K(e,u,f[u]);return e},G=(e,f)=>le(e,ae(f));import{c as N,u as o,d as ie,G as de,n as fe,l as b,i as me,ac as U,z as ue,E as he}from"./vue-f962b0e4.js";import{c as Q}from"./componentMap-d26e5f5b.js";import{n as P,z as X,i as be,a6 as pe,c as ge,a7 as ye,a8 as Ce,a9 as Y,u as Pe}from"./index.js";import{i as xe,N as we,c as Z,s as Ae}from"./helper-b0407d84.js";import{i as Se}from"./isNumber-f0336cfd.js";import{i as k}from"./isBoolean-9388e2d6.js";import{q as ee,E as Ie,y as te}from"./antd-2f1e67c0.js";function ve(e){return"slot"in e}function Re(e){return!ve(e)}function je(e,f){return N(()=>{const u=o(e),{labelCol:F={},wrapperCol:q={}}=u.itemProps||{},{labelWidth:T,disabledLabelWidth:h}=u,{labelWidth:g,labelCol:j,wrapperCol:L,layout:_}=o(f);if(!g&&!T&&!j||h)return F.style={textAlign:"left"},{labelCol:F,wrapperCol:q};let x=T||g;const B=d(d({},j),F),O=d(d({},L),q);return x&&(x=Se(x)?`${x}px`:x),{labelCol:d({style:{width:x}},B),wrapperCol:d({style:{width:_==="vertical"?"100%":`calc(100% - ${x})`}},O)}})}function W(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!me(e)}const Te=ie({name:"BasicFormItem",inheritAttrs:!1,props:{schema:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},allDefaultValues:{type:Object,default:()=>({})},formModel:{type:Object,default:()=>({})},setFormModel:{type:Function,default:null},tableAction:{type:Object},formActionType:{type:Object},isAdvanced:{type:Boolean}},setup(e,{slots:f}){const{t:u}=be(),{schema:F,formProps:q}=de(e),T=je(F,q),h=N(()=>{const{allDefaultValues:s,formModel:t,schema:a}=e,{mergeDynamicData:l}=e.formProps;return{field:a.field,model:t,values:d(d(d({},l),s),t),schema:a}}),g=N(()=>{var r;const{schema:s,tableAction:t,formModel:a,formActionType:l}=e;let{componentProps:n={}}=s;return P(n)&&(n=(r=n({schema:s,tableAction:t,formModel:a,formActionType:l}))!=null?r:{}),xe(s.component)&&(n=Object.assign({type:"horizontal"},{orientation:"left",plain:!0},n)),n}),j=N(()=>{const{disabled:s}=e.formProps,{dynamicDisabled:t}=e.schema,{disabled:a=!1}=o(g);let l=!!s||a;return k(t)&&(l=t),P(t)&&(l=t(o(h))),l}),L=N(()=>{const{readonly:s}=e.formProps,{dynamicReadonly:t}=e.schema,{readonly:a=!1}=o(g);let l=s||a;return k(t)&&(l=t),P(t)&&(l=t(o(h))),l});function _(){const{show:s,ifShow:t}=e.schema,{showAdvancedButton:a}=e.formProps,l=a&&k(e.isAdvanced)?e.isAdvanced:!0;let n=!0,r=!0;return k(s)&&(n=s),k(t)&&(r=t),P(s)&&(n=s(o(h))),P(t)&&(r=t(o(h))),n=n&&l,{isShow:n,isIfShow:r}}function x(){var C;const{rules:s=[],component:t,rulesMessageJoinLabel:a,label:l,dynamicRules:n,required:r}=e.schema;if(P(n))return n(o(h));let c=ge(s);const{rulesMessageJoinLabel:w}=e.formProps,A=(Reflect.has(e.schema,"rulesMessageJoinLabel")?a:w)?l:"",m=t?Z(t)+A:A;function y(p,i){const I=p.message||m;return i===void 0||Ce(i)||Array.isArray(i)&&i.length===0||typeof i=="string"&&i.trim()===""||typeof i=="object"&&Reflect.has(i,"checked")&&Reflect.has(i,"halfChecked")&&Array.isArray(i.checked)&&Array.isArray(i.halfChecked)&&i.checked.length===0&&i.halfChecked.length===0?Promise.reject(I):Promise.resolve()}const S=P(r)?r(o(h)):r;S&&(!c||c.length===0?c=[{required:S,validator:y}]:c.findIndex(i=>Reflect.has(i,"required"))===-1&&c.push({required:S,validator:y}));const E=c.findIndex(p=>Reflect.has(p,"required")&&!Reflect.has(p,"validator"));if(E!==-1){const p=c[E],{isShow:i}=_();if(i||(p.required=!1),t){p.message=p.message||m,(t.includes("Input")||t.includes("Textarea"))&&(p.whitespace=!0);const I=(C=o(g))==null?void 0:C.valueFormat;Ae(p,t,I)}}const R=c.findIndex(p=>p.max);return R!==-1&&!c[R].validator&&(c[R].message=c[R].message||u("component.form.maxTip",[c[R].max])),c}function B(){var H;if(!Re(e.schema))return null;const{renderComponentContent:s,component:t,field:a,changeEvent:l="change",watchEventNames:n=["search","change"],enableWatchEvent:r=!0,valueField:c}=e.schema,w=t&&["Switch","Checkbox"].includes(t),v=`on${Y(l)}`,{autoSetPlaceHolder:A,size:m,watchEvent:y}=e.formProps;let S={};if(y&&r){let V=["search"];n.forEach(M=>{let D=500;V.includes(M)&&(D=0),S[`on${Y(M)}`]=Pe((...J)=>{const{reload:se=()=>{}}=e.tableAction||{};se()},D)})}const E={[v]:(...V)=>{const[M]=V;C[v]&&C[v](...V);const D=M?M.target:null,J=D?w?D.checked:D.value:M;e.setFormModel(a,J,e.schema)}},R=Q.get(t),C=G(d({allowClear:!0,size:m},o(g)),{disabled:o(j),readonly:o(L)});!C.disabled&&A&&t!=="RangePicker"&&t&&(C.placeholder=((H=o(g))==null?void 0:H.placeholder)||Z(t)),C.codeField=a,C.formValues=o(h);const i={[c||(w?"checked":"value")]:e.formModel[a]},I=d(d(d(d({},C),E),S),i);if(!s)return b(R,I,null);const z=P(s)?d({},s(o(h),{disabled:o(j),readonly:o(L)})):{default:()=>s};return b(R,I,W(z)?z:{default:()=>[z]})}function O(){const{label:s,helpMessage:t,helpComponentProps:a,subLabel:l}=e.schema,n=l?b("span",null,[s,he(" "),b("span",{class:"text-secondary"},[l])]):s,r=P(t)?t(o(h)):t;return!r||Array.isArray(r)&&r.length===0?n:b("span",null,[n,b(ye,U({placement:"top",class:"mx-1",text:r},a),null)])}function oe(){const{itemProps:s,slot:t,render:a,field:l,suffix:n,component:r}=e.schema,{labelCol:c,wrapperCol:w}=o(T),{colon:v}=e.formProps,A={disabled:o(j),readonly:o(L)};if(r==="Divider"){let m;return b(ee,{span:24},{default:()=>[b(Ie,o(g),W(m=O())?m:{default:()=>[m]})]})}else if(r==="BasicTitle"){let m;return b(te.Item,{labelCol:c,wrapperCol:w,name:l,class:{"suffix-item":!!n}},{default:()=>[b(pe,o(g),W(m=O())?m:{default:()=>[m]})]})}else{const m=()=>t?X(f,t,o(h),A):a?a(o(h),A):B(),y=!!n,S=P(n)?n(o(h)):n;return r&&we.includes(r)&&e.schema&&(e.schema.itemProps=d({autoLink:!1},e.schema.itemProps)),b(te.Item,U({name:l,colon:v,class:{"suffix-item":y}},s,{label:O(),rules:x(),labelCol:c,wrapperCol:w}),{default:()=>[b("div",{style:"display:flex"},[b("div",{style:"flex:1;"},[m()]),y&&b("span",{class:"suffix"},[S])])]})}}return()=>{let s;const{colProps:t={},colSlot:a,renderColContent:l,component:n,slot:r}=e.schema;if(!n||!Q.has(n)&&!r)return null;const{baseColProps:c={}}=e.formProps,w=d(d({},c),t),{isIfShow:v,isShow:A}=_(),m=o(h),y={disabled:o(j),readonly:o(L)};return v&&fe(b(ee,w,W(s=(()=>a?X(f,a,m,y):l?l(m,y):oe())())?s:{default:()=>[s]}),[[ue,A]])}}});export{Te as _};
