var Et=Object.defineProperty,Kt=Object.defineProperties;var Ht=Object.getOwnPropertyDescriptors;var Qe=Object.getOwnPropertySymbols;var Nt=Object.prototype.hasOwnProperty,zt=Object.prototype.propertyIsEnumerable;var Ye=(n,l,t)=>l in n?Et(n,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[l]=t,I=(n,l)=>{for(var t in l||(l={}))Nt.call(l,t)&&Ye(n,t,l[t]);if(Qe)for(var t of Qe(l))zt.call(l,t)&&Ye(n,t,l[t]);return n},fe=(n,l)=>Kt(n,Ht(l));var ne=(n,l,t)=>new Promise((s,a)=>{var c=u=>{try{r(t.next(u))}catch(o){a(o)}},m=u=>{try{r(t.throw(u))}catch(o){a(o)}},r=u=>u.done?s(u.value):Promise.resolve(u.value).then(c,m);r((t=t.apply(n,l)).next())});import{d as ie,Z as H,_ as Te,N as Ce,E as de,a0 as j,l as k,u as e,c as F,f as z,w as ve,H as Se,m as qe,r as ut,h as Ge,o as We,x as $e,an as Bt,J as ct,a7 as Lt,a8 as V,a9 as R,$ as se,a1 as _e,ab as Q,F as Mt,aa as Ve,ag as Ut,e as jt,ad as et,ai as Ke,aj as He,ac as tt,n as Vt,z as qt}from"./vue-f962b0e4.js";import{_ as Gt}from"./BasicForm.vue_vue_type_script_setup_true_lang-25143c9d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1182c765.js";import{P as Je,b as Wt,D as Jt,I as Be,A as Le,R as oe,F as Xt,u as Ae,d as Zt}from"./componentMap-d26e5f5b.js";import{u as Qt}from"./useForm-8838369c.js";import{ap as Yt,aq as en,ar as nt,h as Oe,i as Ie,R as ze,c as ge,a2 as tn,n as q,q as Me,r as nn,as as an,at as ln,L as on,Q as sn,o as ft,au as rn,ac as un,I as at,av as dt,U as lt,aw as cn,a6 as fn,z as je,M as dn,P as gn,a5 as hn}from"./index.js";import{aj as mn,ak as pn,al as Cn,ai as vn,z as De,am as Sn,T as xe,E as gt,an as bn,D as wn,d as Ne,ao as yn,ap as _n,ae as Tn,ad as Rn,aq as xn}from"./antd-2f1e67c0.js";import{a as In,u as ht,b as kn,c as Fn,d as Pn}from"./TableImg.vue_vue_type_style_index_0_lang-0ed7d68a.js";import{i as he}from"./isBoolean-9388e2d6.js";import{b as ot}from"./uuid-31b8b5a4.js";import{g as st}from"./get-3d19de2f.js";import Dn from"./sortable.esm-4ae27e0b.js";var $n=Yt(function(n,l,t){en(n,l,t)});const An=$n,On={class:"edit-header-cell"},it=ie({name:"EditTableHeaderIcon",__name:"EditTableHeaderIcon",props:{title:{type:String,default:""}},setup(n){return(l,t)=>(H(),Te("span",On,[Ce(l.$slots,"default"),de(" "+j(n.title)+" ",1),k(e(mn))]))}}),En=ie({name:"TableHeaderCell",components:{EditTableHeaderCell:it,BasicHelp:nt},props:{column:{type:Object,default:()=>({})}},setup(n){const{prefixCls:l}=Oe("basic-table-header-cell"),t=F(()=>{var c;return!!((c=n.column)!=null&&c.edit)}),s=F(()=>{var m;const c=n.column;return typeof c.customHeaderRender=="function"?c.customHeaderRender(c):(c==null?void 0:c.customTitle)||((m=n.column)==null?void 0:m.title)}),a=F(()=>{var c;return(c=n.column)==null?void 0:c.helpMessage});return()=>k("div",null,[t.value?k(it,null,{default:()=>[s.value]}):k("span",{class:"default-header-cell"},[s.value]),a.value&&k(nt,{text:a.value,class:`${l}__help`},null)])}});function Kn({page:n,type:l,originalElement:t}){return l==="prev"?n===0?null:k(pn,null,null):l==="next"?n===1?null:k(Cn,null,null):t}function Hn(n){const{t:l}=Ie(),t=z({}),s=z(!0);ve(()=>e(n).pagination,o=>{!he(o)&&o&&(t.value=I(I({},e(t)),o!=null?o:{}))});const a=F(()=>{const{pagination:o}=e(n);return!e(s)||he(o)&&!o?!1:I(I({current:1,size:"small",defaultPageSize:Je,showTotal:T=>l("component.table.total",{total:T}),showSizeChanger:!0,pageSizeOptions:Wt,itemRender:Kn,showQuickJumper:!0},he(o)?{}:o),e(t))});function c(o){const T=e(a);t.value=I(I({},he(T)?{}:T),o)}function m(){return e(a)}function r(){return e(s)}function u(o){return ne(this,null,function*(){s.value=o})}return{getPagination:m,getPaginationInfo:a,setShowPagination:u,getShowPagination:r,setPagination:c}}function Nn(n){return({text:l,record:t,index:s})=>(Se(t).onValid=()=>ne(this,null,function*(){if(ze(t==null?void 0:t.validCbs)){const a=((t==null?void 0:t.validCbs)||[]).map(m=>m());return(yield Promise.all(a)).every(m=>!!m)}else return!1}),Se(t).onEdit=(a,c=!1)=>ne(this,null,function*(){var m,r;return c||(t.editable=a),!a&&c?(yield t.onValid())&&(yield(m=t.onSubmitEdit)==null?void 0:m.call(t))?(t.editable=!1,!0):!1:(!a&&!c&&((r=t.onCancelEdit)==null||r.call(t)),!0)}),qe(In,{value:l,record:t,column:n,index:s}))}function mt(n,l){const{key:t,dataIndex:s,children:a}=n;n.align=n.align||Jt,l&&(t||(n.key=typeof s=="object"?s.join("-"):s),he(n.ellipsis)||Object.assign(n,{ellipsis:l})),a&&a.length&&pt(a,!!l)}function pt(n,l){n&&n.forEach(t=>{const{children:s}=t;mt(t,l),pt(s,l)})}function zn(n,l,t){const{t:s}=Ie(),{showIndexColumn:a,indexColumnProps:c,isTreeTable:m}=e(n);let r=!1;if(e(m)||(t.forEach(()=>{const o=t.findIndex(T=>T.flag===Be);a?r=o===-1:!a&&o!==-1&&t.splice(o,1)}),!r))return;const u=t.some(o=>o.fixed==="left");t.unshift(I(I({flag:Be,width:60,title:s("component.table.index"),align:"center",customRender:({index:o})=>{const T=e(l);if(he(T))return`${o+1}`;const{current:w=1,pageSize:x=Je}=T;return((w<1?1:w)-1)*x+o+1}},u?{fixed:"left"}:{}),c))}function Bn(n,l){const{actionColumn:t}=e(n);if(!t)return;const s=l.findIndex(a=>a.flag===Le);s===-1&&l.push(fe(I(fe(I({},l[s]),{fixed:"right"}),t),{flag:Le}))}function Ln(n,l){const t=z(e(n).columns);let s=e(n).columns;const a=F(()=>{const g=ge(e(t));if(zn(n,l,g),Bn(n,g),!g)return[];const{ellipsis:f}=e(n);return g.forEach(v=>{const{customRender:S,slots:b}=v;mt(v,Reflect.has(v,"ellipsis")?!!v.ellipsis:!!f&&!S&&!b)}),g});function c(g){const f=g.ifShow;let v=!0;return he(f)&&(v=f),q(f)&&(v=f(g)),v}const{hasPermission:m}=tn(),r=F(()=>{const g=rt(e(a)),f=S=>{const{slots:b,customRender:P,format:D,edit:O,editRow:G,flag:Y}=S;(!b||!(b!=null&&b.title))&&(S.customTitle=S.title);const re=[Be,Le].includes(Y);return!P&&D&&!O&&!re&&(S.customRender=({text:be,record:h,index:p})=>Mn(be,D,h,p)),(O||G)&&!re&&(S.customRender=Nn(S)),ut(S)};return ge(g).filter(S=>m(S.auth)&&c(S)).map(S=>{var b;return(b=S.children)!=null&&b.length&&(S.children=S.children.map(f)),f(S)})});ve(()=>e(n).columns,g=>{var f;t.value=g,s=(f=g==null?void 0:g.filter(v=>!v.flag))!=null?f:[]});function u(g,f){!g||!f||s.forEach(v=>{if(v.dataIndex===g){Object.assign(v,f);return}})}function o(g){const f=ge(g);if(!ze(f))return;if(f.length<=0){t.value=[];return}const v=f[0],S=s.map(b=>b.dataIndex);if(!Me(v)&&!ze(v))t.value=f;else{const b=f.map(D=>D.toString()),P=[];s.forEach(D=>{var O;P.push(fe(I({},D),{defaultHidden:!b.includes(((O=D.dataIndex)==null?void 0:O.toString())||D.key)}))}),nn(S,f)||P.sort((D,O)=>{var G,Y;return b.indexOf((G=D.dataIndex)==null?void 0:G.toString())-b.indexOf((Y=O.dataIndex)==null?void 0:Y.toString())}),t.value=P}}function T(g){const{ignoreIndex:f,ignoreAction:v,sort:S}=g||{};let b=Se(e(a));return f&&(b=b.filter(P=>P.flag!==Be)),v&&(b=b.filter(P=>P.flag!==Le)),S&&(b=rt(b)),b}function w(){return s}function x(g){ze(g)&&(s=g.filter(f=>!f.flag))}function y(g,f){f.width=g}return{getColumnsRef:a,getCacheColumns:w,getColumns:T,setColumns:o,setColumnWidth:y,getViewColumns:r,setCacheColumnsByField:u,setCacheColumns:x}}function rt(n){const l=[],t=[],s=[];for(const a of n){if(a.fixed==="left"){l.push(a);continue}if(a.fixed==="right"){t.push(a);continue}s.push(a)}return[...l,...s,...t].filter(a=>!a.defaultHidden)}function Mn(n,l,t,s){if(!l)return n;if(q(l))return l(n,t,s);try{const a="date|";if(Me(l)&&l.startsWith(a)&&n){const c=l.replace(a,"");return c?an(n,c):n}if(ln(l))return l.get(n)}catch(a){return n}}function Un(n,{getPaginationInfo:l,setPagination:t,setLoading:s,getFieldsValue:a,clearSelectedRowKeys:c,tableData:m},r){const u=ut({sortInfo:{},filterInfo:{}}),o=z([]),T=z({});Ge(()=>{m.value=e(o)}),ve(()=>e(n).dataSource,()=>{const{dataSource:h,api:p}=e(n);!p&&h&&(o.value=h)},{immediate:!0});function w(h,p,$){const{clearSelectOnPageChange:E,sortFn:K,filterFn:B}=e(n);E&&c(),t(h);const L={};if($&&q(K)){const A=K($);u.sortInfo=A,L.sortInfo=A}if(p&&q(B)){const A=B(p);u.filterInfo=A,L.filterInfo=A}O(L)}function x(h){!h||!Array.isArray(h)||h.forEach(p=>{p[oe]||(p[oe]=ot()),p.children&&p.children.length&&x(p.children)})}const y=F(()=>e(n).autoCreateKey&&!e(n).rowKey),g=F(()=>{const{rowKey:h}=e(n);return e(y)?oe:h}),f=F(()=>{const h=e(o);if(!h||h.length===0)return e(o);if(e(y)){const p=h[0],$=h[h.length-1];if(p&&$&&(!p[oe]||!$[oe])){const E=ge(e(o));E.forEach(K=>{K[oe]||(K[oe]=ot()),K.children&&K.children.length&&x(K.children)}),o.value=E}}return e(o)});function v(h,p,$){return ne(this,null,function*(){return o.value[h]&&(o.value[h][p]=$),o.value[h]})}function S(h,p){const $=D(h);if($){for(const E in $)Reflect.has(p,E)&&($[E]=p[E]);return $}}function b(h){var K;if(!o.value||o.value.length==0)return;const p=e(g);if(!p)return;const $=Array.isArray(h)?h:[h];function E(B,L){const A=ue(B,L);if(A===null||A.index===-1)return;A.data.splice(A.index,1);function ue(W,ce){var ae;if(W==null)return null;for(let J=0;J<W.length;J++){const ee=W[J];let te=p;if(q(p)&&(te=p(ee)),ee[te]===ce)return{index:J,data:W};if(((ae=ee.children)==null?void 0:ae.length)>0){const X=ue(ee.children,ce);if(X!=null)return X}}return null}}for(const B of $)E(o.value,B),E(e(n).dataSource,B);t({total:(K=e(n).dataSource)==null?void 0:K.length})}function P(h,p){var E;p=p!=null?p:(E=o.value)==null?void 0:E.length;const $=sn(h)?[h]:h;return e(o).splice(p,0,...$),e(o)}function D(h){if(!o.value||o.value.length==0)return;const p=e(g);if(!p)return;const{childrenColumnName:$="children"}=e(n);return(K=>{let B;return K.some(function L(A){if(typeof p=="function"){if(p(A)===h)return B=A,!0}else if(Reflect.has(A,p)&&A[p]===h)return B=A,!0;return A[$]&&A[$].some(L)}),B})(o.value)}function O(h){return ne(this,null,function*(){var W,ce,ae;const{api:p,searchInfo:$,defSort:E,fetchSetting:K,beforeFetch:B,afterFetch:L,useSearchForm:A,pagination:ue}=e(n);if(!(!p||!q(p)))try{s(!0);const{pageField:J,sizeField:ee,listField:te,totalField:X}=Object.assign({},Xt,K);let le={};const{current:we=1,pageSize:me=Je}=e(l);he(ue)&&!ue||he(l)?le={}:(le[J]=h&&h.page||we,le[ee]=me);const{sortInfo:Re={},filterInfo:ke}=u;let pe=An(le,A?a():{},$,(W=h==null?void 0:h.searchInfo)!=null?W:{},E,Re,ke,(ce=h==null?void 0:h.sortInfo)!=null?ce:{},(ae=h==null?void 0:h.filterInfo)!=null?ae:{});B&&q(B)&&(pe=(yield B(pe))||pe);const i=yield p(pe);T.value=i;const C=Array.isArray(i);let _=C?i:st(i,te);const d=C?i.length:st(i,X);if(Number(d)){const M=Math.ceil(d/me);if(we>M)return t({current:M}),yield O(h)}return L&&q(L)&&(_=(yield L(_))||_),o.value=_,t({total:d||0}),h&&h.page&&t({current:h.page||1}),r("fetch-success",{items:e(_),total:d}),_}catch(J){r("fetch-error",J),o.value=[],t({total:0})}finally{s(!1)}})}function G(h){o.value=h}function Y(){return f.value}function re(){return T.value}function be(h){return ne(this,null,function*(){return yield O(h)})}return We(()=>{on(()=>{e(n).immediate&&O()},16)}),{getDataSourceRef:f,getDataSource:Y,getRawDataSource:re,getRowKey:g,setTableData:G,getAutoCreateKey:y,fetch:O,reload:be,updateTableData:v,updateTableDataRecord:S,deleteTableDataRecord:b,insertTableDataRecord:P,findTableDataRecord:D,handleTableChange:w}}function jn(n){const l=z(e(n).loading);ve(()=>e(n).loading,a=>{l.value=a});const t=F(()=>e(l));function s(a){l.value=a}return{getLoading:t,setLoading:s}}function Vn(n,l,t){const s=z([]),a=z([]),c=F(()=>{const{rowSelection:f}=e(n);return f?I({selectedRowKeys:e(s),onChange:v=>{u(v)}},ft(f,["onChange"])):null});ve(()=>{var f;return(f=e(n).rowSelection)==null?void 0:f.selectedRowKeys},f=>{u(f)}),ve(()=>e(s),()=>{$e(()=>{const{rowSelection:f}=e(n);if(f){const{onChange:v}=f;v&&q(v)&&v(x(),y())}t("selection-change",{keys:x(),rows:y()})})},{deep:!0});const m=F(()=>e(n).autoCreateKey&&!e(n).rowKey),r=F(()=>{const{rowKey:f}=e(n);return e(m)?oe:f});function u(f){var b;s.value=f||[];const v=rn(Se(e(l)).concat(Se(e(a))),P=>f==null?void 0:f.includes(P[e(r)]),{children:(b=n.value.childrenColumnName)!=null?b:"children"}),S=[];f==null||f.forEach(P=>{const D=v.find(O=>O[e(r)]===P);D&&S.push(D)}),a.value=S}function o(f){a.value=f}function T(){a.value=[],s.value=[]}function w(f){const S=e(s).findIndex(b=>b===f);S!==-1&&e(s).splice(S,1)}function x(){return e(s)}function y(){return e(a)}function g(){return e(c)}return{getRowSelection:g,getRowSelectionRef:c,getSelectRows:y,getSelectRowKeys:x,setSelectedRowKeys:u,clearSelectedRowKeys:T,deleteSelectRowByKey:w,setSelectedRows:o}}function qn(n,l){let t;function s(c){return ne(this,null,function*(){var u;const{id:m}=c,r=t==null?void 0:t.querySelector(`[data-row-key="${m}"]`);yield $e(),t==null||t.scrollTo({top:(u=r==null?void 0:r.offsetTop)!=null?u:0,behavior:"smooth"})})}function a(c){const m=e(n);if(!m)return;const r=m.$el;if(!r||!t&&(t=r.querySelector(".ant-table-body"),!t))return;const u=e(l);if(u)if(c==="top")s(u[0]);else if(c==="bottom")s(u[u.length-1]);else{const o=u.find(T=>T.id===c);o&&s(o)}}return{scrollTo:a}}function Gn(n,l,t){return!l||t?n[oe]:Me(l)?n[l]:q(l)?n[l(n)]:null}function Wn(n,{setSelectedRowKeys:l,getSelectRowKeys:t,getAutoCreateKey:s,clearSelectedRowKeys:a,emit:c}){return{customRow:(r,u)=>({onClick:o=>{o==null||o.stopPropagation();function T(){var b;const{rowSelection:w,rowKey:x,clickToRowSelect:y}=e(n);if(!w||!y)return;const g=t()||[],f=Gn(r,x,e(s));if(f===null)return;if(w.type==="checkbox"){const P=(b=o.composedPath)==null?void 0:b.call(o).find(G=>G.tagName==="TR");if(!P)return;const D=P.querySelector("input[type=checkbox]");if(!D||D.hasAttribute("disabled"))return;if(!g.includes(f)){g.push(f),l(g);return}const O=g.findIndex(G=>G===f);g.splice(O,1),l(g);return}if(w.type==="radio"){if(!g.includes(f)){g.length&&a(),l([f]);return}a()}}T(),c("row-click",r,u,o)},onDblclick:o=>{c("row-dbClick",r,u,o)},onContextmenu:o=>{c("row-contextmenu",r,u,o)},onMouseenter:o=>{c("row-mouseenter",r,u,o)},onMouseleave:o=>{c("row-mouseleave",r,u,o)}})}}function Jn(n,l){function t(s,a){const{striped:c,rowClassName:m}=e(n),r=[];return c&&r.push((a||0)%2===1?`${l}-row__striped`:""),m&&q(m)&&r.push(m(s,a)),r.filter(u=>!!u).join(" ")}return{getRowClassName:t}}const Xn=["data-no"],Zn=ie({name:"ColumnSetting",__name:"ColumnSetting",emits:["columns-change"],setup(n,{emit:l}){const t=ht(),s=Bt(),{t:a}=Ie(),{prefixCls:c}=Oe("basic-column-setting"),m=ct(),r=Ae(),u=()=>q(m.getPopupContainer)?m.getPopupContainer():dt();let o=!1,T=!1;const w=z([]),x=z(null),y=z([]);ve(y,()=>{o&&(w.value.filter(i=>y.value.includes(i.value)).forEach(i=>{i.column.defaultHidden=!1}),w.value.filter(i=>!y.value.includes(i.value)).forEach(i=>{i.column.defaultHidden=!0,i.fixed=void 0}),W(),K(),O())});const g=z(!1),f=()=>{y.value.length<w.value.length?y.value=w.value.map(i=>i.value):y.value=[]},v=F(()=>y.value.length>0&&y.value.length<w.value.length),S=z(!1),b=i=>{if(ae(i.target.checked),t.setShowIndexColumn(i.target.checked),i.target.checked){const C=ge(r==null?void 0:r.getColumns()),_=C.findIndex(d=>d.flag==="INDEX");if(_>-1){const d=C[_];d.fixed="left",C.splice(_,1),C.splice(0,0,d),E(C)}}},P=z(!1),D=i=>{J(i.target.checked),t.setShowRowSelection(i.target.checked)},O=()=>{typeof s.name=="string"&&t.setColumns(s.name,w.value)},G=()=>{S.value=te,b({target:{checked:te}}),P.value=X,D({target:{checked:X}}),w.value=ge(we),p=me,h==null||h.sort(me),ee()},Y=(i,C)=>{C==="left"?!i.fixed||i.fixed==="right"?i.fixed="left":i.fixed=void 0:C==="right"&&(!i.fixed||i.fixed==="left"?i.fixed="right":i.fixed=void 0),K(),O()},re=()=>ne(this,null,function*(){if(x.value){const i=x.value.$el;Array.from(i.children).forEach(C=>i.removeChild(C))}yield $e()}),be=i=>{if(i){if("ifShow"in i){if(typeof i.ifShow=="boolean")return i.ifShow;if(i.ifShow)return i.ifShow(i)}return!0}return!1};let h,p=[];const $=()=>r.getColumns({ignoreIndex:!0,ignoreAction:!0}).filter(i=>be(i)),E=i=>{T=!0,r==null||r.setColumns(i);const C=i.map(_=>({dataIndex:_.dataIndex?_.dataIndex.toString():"",fixed:_.fixed,visible:!_.defaultHidden}));l("columns-change",C)},K=()=>{var _;const i=ge(r.getColumns());let C=i.filter(d=>d.fixed==="left"||d.fixed===!0).length;for(const d of w.value){const M=i.findIndex(ye=>ye.dataIndex===d.value);if(M>-1){const ye=i[M];ye.defaultHidden=(_=d.column)==null?void 0:_.defaultHidden,ye.fixed=d.fixed,i.splice(M,1),i.splice(C++,0,ye)}}E(i)},B=()=>ne(this,null,function*(){if(yield $e(),x.value){const i=x.value.$el;h=Dn.create(e(i),{animation:500,delay:400,delayOnTouchOnly:!0,handle:".table-column-drag-icon ",dataIdAttr:"data-no",onEnd:C=>{const{oldIndex:_,newIndex:d}=C;if(lt(_)||lt(d)||_===d)return;const M=ge(w.value);_>d?(M.splice(d,0,M[_]),M.splice(_+1,1)):(M.splice(d+1,0,M[_]),M.splice(_,1)),w.value=M,K(),O()}}),h.sort(p)}}),L=()=>{if(typeof s.name=="string"){let i=t.getColumns(s.name);if(i&&JSON.stringify(w.value.map(C=>({value:C.value,label:C.label})))!==JSON.stringify(i.map(C=>({value:C.value,label:C.label})))){const C=w.value.reduce((_,d)=>(_[d.value]=d.label,_),{});if(Array.isArray(i)){i=i.filter(d=>C[d.value]),i.forEach(d=>{d.label=C[d.value]});const _=i.map(d=>d.value);i=i.concat(w.value.filter(d=>!_.includes(d.value))),t.setColumns(s.name,i)}}}},A=()=>{if(typeof t.getShowIndexColumn=="boolean"&&(S.value=t.getShowIndexColumn),typeof t.getShowRowSelection=="boolean"&&(P.value=X&&t.getShowRowSelection),b({target:{checked:S.value}}),D({target:{checked:P.value}}),typeof s.name=="string"){const i=t.getColumns(s.name);Array.isArray(i)&&(w.value=i)}},ue=()=>{y.value=w.value.filter(i=>{var C;return!((C=i.column)!=null&&C.defaultHidden)}).map(i=>i.value)},W=()=>{g.value=w.value.length===y.value.length},ce=i=>{p=i.map(C=>C.value)},ae=i=>{T=!0,r.setProps({showIndexColumn:i})},J=i=>{T=!0,r.setProps({rowSelection:i?fe(I({},le),{fixed:!0}):void 0})},ee=()=>{ue(),W(),ce(w.value),ae(S.value),J(P.value),K()};let te=!1,X=!1,le,we=[],me=[];const Re=()=>ne(this,null,function*(){var i;if(!o){yield re();const C=$();(i=r.setCacheColumns)==null||i.call(r,C);const _=[];for(const d of C)_.push({label:typeof d.title=="string"?d.title:d.customTitle==="string"?d.customTitle:"",value:typeof d.dataIndex=="string"?d.dataIndex:d.title==="string"?d.title:"",column:{defaultHidden:d.defaultHidden},fixed:d.fixed});me=_.map(d=>d.value),te=r.getBindValues.value.showIndexColumn||!1,le=r.getRowSelection(),X=!!le,we=_,S.value=te,P.value=X,w.value=ge(_),L(),A(),ee(),o=!0}});Re();const ke=F(()=>r==null?void 0:r.getColumns()),pe=F(()=>r==null?void 0:r.getBindValues);return We(()=>{ve([ke,pe],()=>{T?T=!1:(o=!1,Re())})}),(i,C)=>{const _=Lt("a-button");return H(),V(e(xe),{placement:"top"},{title:R(()=>[se("span",null,j(e(a)("component.table.settingColumn")),1)]),default:R(()=>[k(e(vn),{placement:"bottomLeft",trigger:"click",onOpenChange:B,overlayClassName:`${e(c)}__column-list`,getPopupContainer:u},{title:R(()=>[se("div",{class:_e(`${e(c)}__popover-title`)},[k(e(De),{indeterminate:v.value,checked:g.value,"onUpdate:checked":C[0]||(C[0]=d=>g.value=d),onChange:f},{default:R(()=>[de(j(e(a)("component.table.settingColumnShow")),1)]),_:1},8,["indeterminate","checked"]),k(e(De),{checked:S.value,"onUpdate:checked":C[1]||(C[1]=d=>S.value=d),onChange:b},{default:R(()=>[de(j(e(a)("component.table.settingIndexColumnShow")),1)]),_:1},8,["checked"]),e(X)?(H(),V(e(De),{key:0,checked:P.value,"onUpdate:checked":C[2]||(C[2]=d=>P.value=d),onChange:D},{default:R(()=>[de(j(e(a)("component.table.settingSelectColumnShow")),1)]),_:1},8,["checked"])):Q("",!0),k(_,{size:"small",type:"link",onClick:G},{default:R(()=>[de(j(e(a)("common.resetText")),1)]),_:1})],2)]),content:R(()=>[k(e(un),null,{default:R(()=>[k(e(De).Group,{value:y.value,"onUpdate:value":C[3]||(C[3]=d=>y.value=d),ref_key:"columnOptionsRef",ref:x},{default:R(()=>[(H(!0),Te(Mt,null,Ve(w.value,d=>(H(),Te("div",{key:d.value,class:_e(`${e(c)}__check-item`),"data-no":d.value},[k(e(Sn),{class:"table-column-drag-icon"}),k(e(De),{value:d.value},{default:R(()=>[de(j(d.label),1)]),_:2},1032,["value"]),k(e(xe),{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:u},{title:R(()=>[de(j(e(a)("component.table.settingFixedLeft")),1)]),default:R(()=>[k(at,{icon:"line-md:arrow-align-left",class:_e([`${e(c)}__fixed-left`,{active:d.fixed==="left",disabled:d.value?!y.value.includes(d.value):!0}]),onClick:M=>Y(d,"left")},null,8,["class","onClick"])]),_:2},1024),k(e(gt),{type:"vertical"}),k(e(xe),{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:u},{title:R(()=>[de(j(e(a)("component.table.settingFixedRight")),1)]),default:R(()=>[k(at,{icon:"line-md:arrow-align-left",class:_e([`${e(c)}__fixed-right`,{active:d.fixed==="right",disabled:d.value?!y.value.includes(d.value):!0}]),onClick:M=>Y(d,"right")},null,8,["class","onClick"])]),_:2},1024)],10,Xn))),128))]),_:1},8,["value"])]),_:1})]),default:R(()=>[k(e(bn))]),_:1},8,["overlayClassName"])]),_:1})}}}),Qn=ie({name:"SizeSetting",__name:"SizeSetting",setup(n){const l=ht(),t=Ae(),{t:s}=Ie(),a=z([t.getSize()]),c=({key:m})=>{a.value=[m],l.setTableSize(m),t.setProps({size:m})};return We(()=>{a.value=[l.getTableSize],t.setProps({size:a.value[0]})}),(m,r)=>(H(),V(e(xe),{placement:"top"},{title:R(()=>[se("span",null,j(e(s)("component.table.settingDens")),1)]),default:R(()=>[k(e(wn),{placement:"bottom",trigger:["click"],getPopupContainer:e(dt)},{overlay:R(()=>[k(e(Ne),{onClick:c,selectable:"",selectedKeys:a.value,"onUpdate:selectedKeys":r[0]||(r[0]=u=>a.value=u)},{default:R(()=>[k(e(Ne).Item,{key:"default"},{default:R(()=>[se("span",null,j(e(s)("component.table.settingDensDefault")),1)]),_:1}),k(e(Ne).Item,{key:"middle"},{default:R(()=>[se("span",null,j(e(s)("component.table.settingDensMiddle")),1)]),_:1}),k(e(Ne).Item,{key:"small"},{default:R(()=>[se("span",null,j(e(s)("component.table.settingDensSmall")),1)]),_:1})]),_:1},8,["selectedKeys"])]),default:R(()=>[k(e(yn))]),_:1},8,["getPopupContainer"])]),_:1}))}}),Yn=ie({name:"RedoSetting",__name:"RedoSetting",setup(n){const l=Ae(),{t}=Ie();function s(){l.reload()}return(a,c)=>(H(),V(e(xe),{placement:"top"},{title:R(()=>[se("span",null,j(e(t)("common.redo")),1)]),default:R(()=>[k(e(_n),{onClick:s})]),_:1}))}}),ea=ie({name:"FullScreenSetting",__name:"FullScreenSetting",setup(n){const l=Ae(),{t}=Ie(),{toggle:s,isFullscreen:a}=cn(l.wrapRef);return(c,m)=>(H(),V(e(xe),{placement:"top"},{title:R(()=>[se("span",null,j(e(t)("component.table.settingFullScreen")),1)]),default:R(()=>[e(a)?(H(),V(e(Rn),{key:1,onClick:e(s)},null,8,["onClick"])):(H(),V(e(Tn),{key:0,onClick:e(s)},null,8,["onClick"]))]),_:1}))}}),ta={class:"table-settings"},na=ie({name:"TableSetting",__name:"index",props:{setting:{type:Object,default:()=>({})}},emits:["columns-change"],setup(n,{emit:l}){const t=n,s=Ae(),a=F(()=>I({redo:!0,size:!0,setting:!0,fullScreen:!1},t.setting));function c(r){l("columns-change",r)}function m(){return s?e(s.wrapRef):document.body}return(r,u)=>(H(),Te("div",ta,[a.value.redo?(H(),V(Yn,{key:0,getPopupContainer:m})):Q("",!0),a.value.size?(H(),V(Qn,{key:1,getPopupContainer:m})):Q("",!0),a.value.setting?(H(),V(Zn,{key:2,onColumnsChange:c,getPopupContainer:m})):Q("",!0),a.value.fullScreen?(H(),V(ea,{key:3,getPopupContainer:m})):Q("",!0)]))}}),aa=ie({name:"BasicTableTitle",__name:"TableTitle",props:{title:{type:[Function,String]},getSelectRows:{type:Function},helpMessage:{type:[String,Array]}},setup(n){const l=n,{prefixCls:t}=Oe("basic-table-title"),s=F(()=>{const{title:a,getSelectRows:c=()=>{}}=l;let m=a;return q(a)&&(m=a({selectRows:c()})),m});return(a,c)=>s.value?(H(),V(e(fn),{key:0,class:_e(e(t)),helpMessage:n.helpMessage},{default:R(()=>[de(j(s.value),1)]),_:1},8,["class","helpMessage"])):Q("",!0)}}),la={style:{width:"100%"}},oa={key:0,style:{margin:"5px"}},sa={class:"flex items-center"},ia=ie({name:"BasicTableHeader",__name:"TableHeader",props:{title:{type:[Function,String]},tableSetting:{type:Object},showTableSetting:{type:Boolean},titleHelpMessage:{type:[String,Array],default:""}},emits:["columns-change"],setup(n,{emit:l}){const{prefixCls:t}=Oe("basic-table-header");function s(a){l("columns-change",a)}return(a,c)=>(H(),Te("div",la,[a.$slots.headerTop?(H(),Te("div",oa,[Ce(a.$slots,"headerTop")])):Q("",!0),se("div",sa,[a.$slots.tableTitle?Ce(a.$slots,"tableTitle",{key:0}):Q("",!0),!a.$slots.tableTitle&&n.title?(H(),V(aa,{key:1,helpMessage:n.titleHelpMessage,title:n.title},null,8,["helpMessage","title"])):Q("",!0),se("div",{class:_e(`${e(t)}__toolbar`)},[Ce(a.$slots,"toolbar"),a.$slots.toolbar&&n.showTableSetting?(H(),V(e(gt),{key:0,type:"vertical"})):Q("",!0),n.showTableSetting?(H(),V(na,{key:1,setting:n.tableSetting,onColumnsChange:s},null,8,["setting"])):Q("",!0)],2)])]))}});function ra(n,l,t){return{getHeaderProps:F(()=>{const{title:a,showTableSetting:c,titleHelpMessage:m,tableSetting:r}=e(n),u=!l.tableTitle&&!a&&!l.toolbar&&!c;return u&&!Me(a)?{}:{title:u?null:()=>qe(ia,{title:a,titleHelpMessage:m,showTableSetting:c,tableSetting:r,onColumnsChange:t.onColumnsChange},I(I(I({},l.toolbar?{toolbar:()=>je(l,"toolbar")}:{}),l.tableTitle?{tableTitle:()=>je(l,"tableTitle")}:{}),l.headerTop?{headerTop:()=>je(l,"headerTop")}:{}))}})}}function ua(n,l,t){const s=z([]),a=F(()=>e(n).autoCreateKey&&!e(n).rowKey),c=F(()=>{const{rowKey:x}=e(n);return e(a)?oe:x}),m=F(()=>{const{isTreeTable:x}=e(n);return x?{expandedRowKeys:e(s),onExpandedRowsChange:y=>{s.value=y,t("expanded-rows-change",y)}}:{}});function r(){const x=w();s.value=x}function u(){s.value=[]}function o(x){const{isTreeTable:y}=e(n);y&&(s.value=[...s.value,...x])}function T(x){const{isTreeTable:y}=e(n);y&&(s.value=e(s).filter(g=>!x.includes(g)))}function w(x){const y=[],{childrenColumnName:g}=e(n);return Se(x||e(l)).forEach(f=>{y.push(f[e(c)]);const v=f[g||"children"];v!=null&&v.length&&y.push(...w(v))}),y}return{getExpandOption:m,expandAll:r,collapseAll:u,expandRows:o,collapseRows:T}}function ca(n,l,t,s){const a=F(()=>(e(s)||[]).length===0),c=F(()=>{const{summaryFunc:r,showSummary:u,summaryData:o}=e(n);return u&&!e(a)?()=>qe(kn,{summaryFunc:r,summaryData:o,scroll:e(l)}):void 0});Ge(()=>{m()});function m(){const{showSummary:r}=e(n);!r||e(a)||$e(()=>{const u=e(t);if(!u)return;const o=u.$el.querySelector(".ant-table-content");dn({el:o,name:"scroll",listener:()=>{const T=u.$el.querySelector(".ant-table-footer .ant-table-content");!T||!o||(T.scrollLeft=o.scrollLeft)},wait:0,options:!0})})}return{getFooterProps:c}}function fa(n,l,t,s){const a=F(()=>{const{formConfig:u}=e(n),{submitButtonOptions:o}=u||{};return fe(I({showAdvancedButton:!0},u),{submitButtonOptions:I({loading:e(s)},o),compact:!0})}),c=F(()=>Object.keys(l).map(o=>o.startsWith("form-")?o:null).filter(o=>!!o));function m(u){var o,T;return u&&(T=(o=u==null?void 0:u.replace)==null?void 0:o.call(u,/form-/,""))!=null?T:""}function r(u){const{handleSearchInfoFn:o}=e(n);o&&q(o)&&(u=o(u)||u),t({searchInfo:u,page:1})}return{getFormProps:a,replaceFormSlotKey:m,getFormSlotKeys:c,handleSearchInfoChange:r}}const Ra=ie({name:"BasicTable",__name:"BasicTable",props:Fn,emits:["fetch-success","fetch-error","selection-change","register","row-click","row-dbClick","row-contextmenu","row-mouseenter","row-mouseleave","edit-end","edit-cancel","edit-row-end","edit-change","expanded-rows-change","change","columns-change"],setup(n,{expose:l,emit:t}){const s=n,a=ct(),c=Ut(),m=z(null),r=z([]),u=z(null),o=z(null),T=z(),{prefixCls:w}=Oe("basic-table"),[x,y]=Qt(),g=F(()=>I(I({},s),e(T))),f=jt(gn,!1);Ge(()=>{e(f)&&s.canResize&&hn()});const{getLoading:v,setLoading:S}=jn(g),{getPaginationInfo:b,getPagination:P,setPagination:D,setShowPagination:O,getShowPagination:G}=Hn(g),{getRowSelection:Y,getRowSelectionRef:re,getSelectRows:be,setSelectedRows:h,clearSelectedRowKeys:p,getSelectRowKeys:$,deleteSelectRowByKey:E,setSelectedRowKeys:K}=Vn(g,r,t),{handleTableChange:B,getDataSourceRef:L,getDataSource:A,getRawDataSource:ue,setTableData:W,updateTableDataRecord:ce,deleteTableDataRecord:ae,insertTableDataRecord:J,findTableDataRecord:ee,fetch:te,getRowKey:X,reload:le,getAutoCreateKey:we,updateTableData:me}=Un(g,{tableData:r,getPaginationInfo:b,setLoading:S,setPagination:D,getFieldsValue:y.getFieldsValue,clearSelectedRowKeys:p},t);function Re(N,Z,U,Pe){B(N,Z,U),t("change",N,Z,U);const{onChange:Ue}=e(g);Ue&&q(Ue)&&Ue(N,Z,U,Pe)}const{getViewColumns:ke,getColumns:pe,setCacheColumnsByField:i,setCacheColumns:C,setColumnWidth:_,setColumns:d,getColumnsRef:M,getCacheColumns:ye}=Ln(g,b),{getScrollRef:Xe,redoHeight:Ze}=Pn(g,m,M,re,L,u,o),{scrollTo:Ct}=qn(m,L),{customRow:vt}=Wn(g,{setSelectedRowKeys:K,getSelectRowKeys:$,clearSelectedRowKeys:p,getAutoCreateKey:we,emit:t}),{getRowClassName:St}=Jn(g,w),{getExpandOption:bt,expandAll:wt,expandRows:yt,collapseRows:_t,collapseAll:Tt}=ua(g,r,t),Rt={onColumnsChange:N=>{var Z,U;t("columns-change",N),(U=(Z=e(g)).onColumnsChange)==null||U.call(Z,N)}},{getHeaderProps:xt}=ra(g,c,Rt),{getFooterProps:It}=ca(g,Xe,m,L),{getFormProps:kt,replaceFormSlotKey:Ft,getFormSlotKeys:Pt,handleSearchInfoChange:Dt}=fa(g,c,te,v),Fe=F(()=>{const N=e(L);let Z=I(fe(I(I(fe(I({},a),{customRow:vt}),e(g)),e(xt)),{scroll:e(Xe),loading:e(v),tableLayout:"fixed",rowSelection:e(re),rowKey:e(X),columns:Se(e(ke)),pagination:Se(e(b)),dataSource:N,footer:e(It)}),e(bt));return Z=ft(Z,["class","onChange"]),Z}),$t=F(()=>{const N=e(Fe);return[w,a.class,{[`${w}-form-container`]:N.useSearchForm,[`${w}--inset`]:N.inset}]}),At=F(()=>{const{emptyDataIsShowTable:N,useSearchForm:Z}=e(g);return N||!Z?!0:!!e(L).length});function Ot(N){T.value=I(I({},e(T)),N)}const Ee={reload:le,getSelectRows:be,setSelectedRows:h,clearSelectedRowKeys:p,getSelectRowKeys:$,deleteSelectRowByKey:E,setPagination:D,setTableData:W,updateTableDataRecord:ce,deleteTableDataRecord:ae,insertTableDataRecord:J,findTableDataRecord:ee,redoHeight:Ze,setSelectedRowKeys:K,setColumns:d,setLoading:S,getDataSource:A,getRawDataSource:ue,setProps:Ot,getRowSelection:Y,getPaginationRef:P,getColumns:pe,getCacheColumns:ye,emit:t,updateTableData:me,setShowPagination:O,getShowPagination:G,setCacheColumnsByField:i,expandAll:wt,collapseAll:Tt,expandRows:yt,collapseRows:_t,scrollTo:Ct,getSize:()=>e(Fe).size,setCacheColumns:C};return Zt(fe(I({},Ee),{wrapRef:u,getBindValues:Fe})),t("register",Ee,y),l(I({tableElRef:m},Ee)),(N,Z)=>(H(),Te("div",{ref_key:"wrapRef",ref:u,class:_e($t.value)},[Fe.value.useSearchForm?(H(),V(e(Gt),tt({key:0,ref_key:"formRef",ref:o,submitOnReset:""},e(kt),{tableAction:Ee,onRegister:e(x),onSubmit:e(Dt),onAdvancedChange:e(Ze)}),et({_:2},[Ve(e(Pt),U=>({name:e(Ft)(U),fn:R(Pe=>[Ce(N.$slots,U,Ke(He(Pe||{})))])}))]),1040,["onRegister","onSubmit","onAdvancedChange"])):Q("",!0),Vt(k(e(xn),tt({ref_key:"tableElRef",ref:m},Fe.value,{rowClassName:e(St),onChange:Re,onResizeColumn:e(_)}),et({headerCell:R(({column:U})=>[Ce(N.$slots,"headerCell",Ke(He({column:U})),()=>[k(En,{column:U},null,8,["column"])])]),bodyCell:R(U=>[Ce(N.$slots,"bodyCell",Ke(He(U||{})))]),_:2},[Ve(Object.keys(N.$slots),U=>({name:U,fn:R(Pe=>[Ce(N.$slots,U,Ke(He(Pe||{})))])}))]),1040,["rowClassName","onResizeColumn"]),[[qt,At.value]])],2))}});export{Ra as _,En as a};
